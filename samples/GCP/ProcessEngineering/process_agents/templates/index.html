<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>Process Viewer</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <!-- Breadcrumb + top controls -->
    <div id="breadcrumb">
        <span id="crumb-level1" class="crumb-clickable">Level 1</span>
        <span id="crumb-sep" style="display:none;">→</span>
        <span id="crumb-step" class="crumb-clickable" style="display:none;"></span>

        <div id="top-controls">
            <button id="dark-toggle-btn">Dark mode</button>
        </div>
    </div>

    <div id="container">
        <div id="canvas-container">
            <svg id="diagram" width="100%" height="100%">
                <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
                        <path d="M0,0 L10,3.5 L0,7 Z" fill="#888"></path>
                    </marker>
                </defs>
                <g id="viewport"></g>
            </svg>

            <svg id="minimap">
                <g id="minimap-content"></g>
                <rect id="minimap-viewport"></rect>
            </svg>

            <button id="zoom-in-btn">+</button>
            <button id="zoom-out-btn">-</button>
            <button id="reset-zoom-btn">Reset Zoom</button>

        </div>

        <div id="info-panel">
            <h2 id="process-title">Loading...</h2>

            <input id="search-box" placeholder="Search steps..." />

            <div id="lane-filters"></div>

            <p style="font-size:13px; color:var(--muted);">
                Double-click a Level 1 step to drill into its subprocess.<br>
                Click the ℹ️ icon on a step to see details.<br>
                Use search to highlight matching steps.
            </p>
        </div>
    </div>

    <!-- Modal -->
    <div id="modal-backdrop">
        <div id="modal">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <h3 id="modal-title" style="margin:0;"></h3>
                <span id="modal-close" style="cursor:pointer; font-size:20px; padding:4px 8px; line-height:1;">
                    <svg width="20" height="20" viewBox="0 0 20 20" aria-label="Close" style="display:block;">
                        <rect x="4" y="4" width="12" height="12" rx="2" fill="none" stroke="currentColor"
                            stroke-width="1.5" />
                        <line x1="7" y1="7" x2="13" y2="13" stroke="currentColor" stroke-width="1.5"
                            stroke-linecap="round" />
                        <line x1="13" y1="7" x2="7" y2="13" stroke="currentColor" stroke-width="1.5"
                            stroke-linecap="round" />
                    </svg>
                </span>
            </div>

            <div id="modal-body" style="max-height:60vh; overflow-y:auto;"></div>

            <button onclick="closeModal()">Close</button>
        </div>
    </div>
    <script src="{{ url_for('static', filename='script.js') }}"></script>

</body>

</html>